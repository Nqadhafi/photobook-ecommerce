/*! For license information please see 21.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[21],{3085:(t,e,r)=>{r.d(e,{A:()=>a});var o=r(6314),n=r.n(o)()(function(t){return t[1]});n.push([t.id,"",""]);const a=n},7597:(t,e,r)=>{r.d(e,{A:()=>p});var o=r(7304);function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function a(){var t,e,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",n=r.toStringTag||"@@toStringTag";function u(r,o,n,a){var u=o&&o.prototype instanceof s?o:s,l=Object.create(u.prototype);return i(l,"_invoke",function(r,o,n){var a,i,u,s=0,l=n||[],p=!1,f={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,r){return a=e,i=0,u=t,f.n=r,c}};function d(r,o){for(i=r,u=o,e=0;!p&&s&&!n&&e<l.length;e++){var n,a=l[e],d=f.p,m=a[2];r>3?(n=m===o)&&(u=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=t):a[0]<=d&&((n=r<2&&d<a[1])?(i=0,f.v=o,f.n=a[1]):d<m&&(n=r<3||a[0]>o||o>m)&&(a[4]=r,a[5]=o,f.n=m,i=0))}if(n||r>1)return c;throw p=!0,o}return function(n,l,m){if(s>1)throw TypeError("Generator is already running");for(p&&1===l&&d(l,m),i=l,u=m;(e=i<2?t:u)||!p;){a||(i?i<3?(i>1&&(f.n=-1),d(i,u)):f.n=u:f.v=u);try{if(s=2,a){if(i||(n="next"),e=a[n]){if(!(e=e.call(a,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,i<2&&(i=0)}else 1===i&&(e=a.return)&&e.call(a),i<2&&(u=TypeError("The iterator does not provide a '"+n+"' method"),i=1);a=t}else if((e=(p=f.n<0)?u:r.call(o,f))!==c)break}catch(e){a=t,i=1,u=e}finally{s=1}}return{value:e,done:p}}}(r,n,a),!0),l}var c={};function s(){}function l(){}function p(){}e=Object.getPrototypeOf;var f=[][o]?e(e([][o]())):(i(e={},o,function(){return this}),e),d=p.prototype=s.prototype=Object.create(f);function m(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,i(t,n,"GeneratorFunction")),t.prototype=Object.create(d),t}return l.prototype=p,i(d,"constructor",p),i(p,"constructor",l),l.displayName="GeneratorFunction",i(p,n,"GeneratorFunction"),i(d),i(d,n,"Generator"),i(d,o,function(){return this}),i(d,"toString",function(){return"[object Generator]"}),(a=function(){return{w:u,m}})()}function i(t,e,r,o){var n=Object.defineProperty;try{n({},"",{})}catch(t){n=0}i=function(t,e,r,o){if(e)n?n(t,e,{value:r,enumerable:!o,configurable:!o,writable:!o}):t[e]=r;else{var a=function(e,r){i(t,e,function(t){return this._invoke(e,r,t)})};a("next",0),a("throw",1),a("return",2)}},i(t,e,r,o)}function u(t,e,r,o,n,a,i){try{var u=t[a](i),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(o,n)}function c(t){return function(){var e=this,r=arguments;return new Promise(function(o,n){var a=t.apply(e,r);function i(t){u(a,o,n,i,c,"next",t)}function c(t){u(a,o,n,i,c,"throw",t)}i(void 0)})}}function s(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,l(o.key),o)}}function l(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==n(e)?e:e+""}const p=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"getAdminCoupons",value:(p=c(a().m(function t(){var e,r,n,i,u=arguments;return a().w(function(t){for(;;)switch(t.p=t.n){case 0:return e=u.length>0&&void 0!==u[0]?u[0]:{},t.p=1,t.n=2,o.A.get("/admin/coupons",{params:e});case 2:return r=t.v,t.a(2,r.data);case 3:throw t.p=3,i=t.v,console.error("CouponService.getAdminCoupons failed:",i),(null===(n=i.response)||void 0===n?void 0:n.data)||{error:"Failed to fetch admin coupons"};case 4:return t.a(2)}},t,null,[[1,3]])})),function(){return p.apply(this,arguments)})},{key:"getAdminCoupon",value:(l=c(a().m(function t(e){var r,n,i;return a().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,o.A.get("/admin/coupons/".concat(e));case 1:return r=t.v,t.a(2,r.data);case 2:throw t.p=2,i=t.v,console.error("CouponService.getAdminCoupon(".concat(e,") failed:"),i),(null===(n=i.response)||void 0===n?void 0:n.data)||{error:"Failed to fetch admin coupon details"};case 3:return t.a(2)}},t,null,[[0,2]])})),function(t){return l.apply(this,arguments)})},{key:"createAdminCoupon",value:(u=c(a().m(function t(e){var r,n,i;return a().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,o.A.post("/admin/coupons",e);case 1:return r=t.v,t.a(2,r.data);case 2:throw t.p=2,i=t.v,console.error("CouponService.createAdminCoupon failed:",i),(null===(n=i.response)||void 0===n?void 0:n.data)||{error:"Failed to create coupon"};case 3:return t.a(2)}},t,null,[[0,2]])})),function(t){return u.apply(this,arguments)})},{key:"updateAdminCoupon",value:(i=c(a().m(function t(e,r){var n,i,u;return a().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,o.A.put("/admin/coupons/".concat(e),r);case 1:return n=t.v,t.a(2,n.data);case 2:throw t.p=2,u=t.v,console.error("CouponService.updateAdminCoupon(".concat(e,") failed:"),u),(null===(i=u.response)||void 0===i?void 0:i.data)||{error:"Failed to update coupon"};case 3:return t.a(2)}},t,null,[[0,2]])})),function(t,e){return i.apply(this,arguments)})},{key:"deleteAdminCoupon",value:(n=c(a().m(function t(e){var r,n,i;return a().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,o.A.delete("/admin/coupons/".concat(e));case 1:return r=t.v,t.a(2,r.data);case 2:throw t.p=2,i=t.v,console.error("CouponService.deleteAdminCoupon(".concat(e,") failed:"),i),(null===(n=i.response)||void 0===n?void 0:n.data)||{error:"Failed to delete coupon"};case 3:return t.a(2)}},t,null,[[0,2]])})),function(t){return n.apply(this,arguments)})}],e&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,i,u,l,p}())},9021:(t,e,r)=>{r.r(e),r.d(e,{default:()=>y});var o=r(7597);function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,o)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach(function(e){u(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function u(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==n(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(){var t,e,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",n=r.toStringTag||"@@toStringTag";function a(r,o,n,a){var c=o&&o.prototype instanceof u?o:u,l=Object.create(c.prototype);return s(l,"_invoke",function(r,o,n){var a,u,c,s=0,l=n||[],p=!1,f={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,r){return a=e,u=0,c=t,f.n=r,i}};function d(r,o){for(u=r,c=o,e=0;!p&&s&&!n&&e<l.length;e++){var n,a=l[e],d=f.p,m=a[2];r>3?(n=m===o)&&(c=a[(u=a[4])?5:(u=3,3)],a[4]=a[5]=t):a[0]<=d&&((n=r<2&&d<a[1])?(u=0,f.v=o,f.n=a[1]):d<m&&(n=r<3||a[0]>o||o>m)&&(a[4]=r,a[5]=o,f.n=m,u=0))}if(n||r>1)return i;throw p=!0,o}return function(n,l,m){if(s>1)throw TypeError("Generator is already running");for(p&&1===l&&d(l,m),u=l,c=m;(e=u<2?t:c)||!p;){a||(u?u<3?(u>1&&(f.n=-1),d(u,c)):f.n=c:f.v=c);try{if(s=2,a){if(u||(n="next"),e=a[n]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,u<2&&(u=0)}else 1===u&&(e=a.return)&&e.call(a),u<2&&(c=TypeError("The iterator does not provide a '"+n+"' method"),u=1);a=t}else if((e=(p=f.n<0)?c:r.call(o,f))!==i)break}catch(e){a=t,u=1,c=e}finally{s=1}}return{value:e,done:p}}}(r,n,a),!0),l}var i={};function u(){}function l(){}function p(){}e=Object.getPrototypeOf;var f=[][o]?e(e([][o]())):(s(e={},o,function(){return this}),e),d=p.prototype=u.prototype=Object.create(f);function m(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,s(t,n,"GeneratorFunction")),t.prototype=Object.create(d),t}return l.prototype=p,s(d,"constructor",p),s(p,"constructor",l),l.displayName="GeneratorFunction",s(p,n,"GeneratorFunction"),s(d),s(d,n,"Generator"),s(d,o,function(){return this}),s(d,"toString",function(){return"[object Generator]"}),(c=function(){return{w:a,m}})()}function s(t,e,r,o){var n=Object.defineProperty;try{n({},"",{})}catch(t){n=0}s=function(t,e,r,o){if(e)n?n(t,e,{value:r,enumerable:!o,configurable:!o,writable:!o}):t[e]=r;else{var a=function(e,r){s(t,e,function(t){return this._invoke(e,r,t)})};a("next",0),a("throw",1),a("return",2)}},s(t,e,r,o)}function l(t,e,r,o,n,a,i){try{var u=t[a](i),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(o,n)}function p(t){return function(){var e=this,r=arguments;return new Promise(function(o,n){var a=t.apply(e,r);function i(t){l(a,o,n,i,u,"next",t)}function u(t){l(a,o,n,i,u,"throw",t)}i(void 0)})}}const f={name:"AdminCouponEdit",props:{id:{type:[String,Number],required:!0}},data:function(){return{loading:!1,coupon:null,errorMessage:"",isSubmitting:!1,minDate:(new Date).toISOString().split("T")[0],form:{code:"",discount_percent:null,max_uses:null,max_uses_per_user:null,starts_at:"",expires_at:"",description:"",is_active:!0},errors:{}}},created:function(){this.fetchCoupon()},methods:{fetchCoupon:function(){var t=this;return p(c().m(function e(){var r,n,a;return c().w(function(e){for(;;)switch(e.p=e.n){case 0:return t.loading=!0,t.errorMessage="",e.p=1,r=t.id,e.n=2,o.A.getAdminCoupon(r);case 2:n=e.v,t.coupon=n,t.form.code=n.code,t.form.discount_percent=null!==n.discount_percent?parseFloat(n.discount_percent):null,t.form.max_uses=null!==n.max_uses?n.max_uses:null,t.form.max_uses_per_user=null!==n.max_uses_per_user?n.max_uses_per_user:null,t.form.starts_at=n.starts_at||"",t.form.expires_at=n.expires_at||"",t.form.description=n.description||"",t.form.is_active=n.is_active,e.n=4;break;case 3:e.p=3,a=e.v,console.error("Failed to fetch coupon details:",a),t.errorMessage=a.error||"Failed to load coupon details. Please try again.";case 4:return e.p=4,t.loading=!1,e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}))()},getValidationState:function(t){return void 0===this.errors[t]?null:!this.errors[t]},submitForm:function(){var t=this;return p(c().m(function e(){var r,n,a,u;return c().w(function(e){for(;;)switch(e.p=e.n){case 0:return t.isSubmitting=!0,t.errors={},e.p=1,r=i({},t.form),e.n=2,o.A.updateAdminCoupon(t.id,r);case 2:n=e.v,t.$bvToast.toast("Coupon '".concat(n.code,"' updated successfully."),{title:"Success",variant:"success",solid:!0}),t.$router.push({name:"AdminCoupons"}),e.n=4;break;case 3:e.p=3,u=e.v,console.error("Failed to update coupon:",u),a=u.error||"Failed to update coupon. Please try again.",u.errors?(t.errors=u.errors,a&&0===Object.keys(u.errors).length&&t.$bvToast.toast(a,{title:"Validation Error",variant:"danger",solid:!0})):t.$bvToast.toast(a,{title:"Error",variant:"danger",solid:!0});case 4:return e.p=4,t.isSubmitting=!1,e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}))()}}};var d=r(5072),m=r.n(d),v=r(3085),b={insert:"head",singleton:!1};m()(v.A,b);v.A.locals;const y=(0,r(4486).A)(f,function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.coupon?r("div",[r("b-row",{staticClass:"mb-3"},[r("b-col",[r("h2",[t._v("Edit Coupon: "+t._s(t.coupon.code))])])],1),t._v(" "),r("b-card",[r("b-form",{on:{submit:function(e){return e.preventDefault(),t.submitForm.apply(null,arguments)}}},[r("b-form-group",{attrs:{label:"Code:","label-for":"coupon-code"}},[r("b-form-input",{attrs:{id:"coupon-code",required:"",placeholder:"Enter unique coupon code",state:t.getValidationState("code"),disabled:!0},model:{value:t.form.code,callback:function(e){t.$set(t.form,"code",e)},expression:"form.code"}}),t._v(" "),r("b-form-text",{attrs:{variant:"secondary"}},[r("small",[t._v("Coupon code cannot be changed after creation.")])]),t._v(" "),r("b-form-invalid-feedback",{attrs:{state:t.getValidationState("code")}},[t._v("\n          "+t._s(t.errors.code)+"\n        ")])],1),t._v(" "),r("b-row",[r("b-col",{attrs:{md:"6"}},[r("b-form-group",{attrs:{label:"Discount Percent (%):","label-for":"coupon-discount-percent"}},[r("b-form-input",{attrs:{id:"coupon-discount-percent",type:"number",min:"0",max:"100",step:"0.01",required:"",placeholder:"e.g., 10.50",state:t.getValidationState("discount_percent")},model:{value:t.form.discount_percent,callback:function(e){t.$set(t.form,"discount_percent",t._n(e))},expression:"form.discount_percent"}}),t._v(" "),r("b-form-invalid-feedback",{attrs:{state:t.getValidationState("discount_percent")}},[t._v("\n              "+t._s(t.errors.discount_percent)+"\n            ")])],1)],1)],1),t._v(" "),r("b-row",[r("b-col",{attrs:{md:"6"}},[r("b-form-group",{attrs:{label:"Max Uses (Total):","label-for":"coupon-max-uses"}},[r("b-form-input",{attrs:{id:"coupon-max-uses",type:"number",min:"0",placeholder:"0 for unlimited"},model:{value:t.form.max_uses,callback:function(e){t.$set(t.form,"max_uses",t._n(e))},expression:"form.max_uses"}}),t._v(" "),r("b-form-text",{attrs:{variant:"secondary"}},[r("small",[t._v("0 or leave blank for unlimited uses.")])])],1)],1),t._v(" "),r("b-col",{attrs:{md:"6"}},[r("b-form-group",{attrs:{label:"Max Uses Per User:","label-for":"coupon-max-uses-per-user"}},[r("b-form-input",{attrs:{id:"coupon-max-uses-per-user",type:"number",min:"1",placeholder:"e.g., 1"},model:{value:t.form.max_uses_per_user,callback:function(e){t.$set(t.form,"max_uses_per_user",t._n(e))},expression:"form.max_uses_per_user"}})],1)],1)],1),t._v(" "),r("b-row",[r("b-col",{attrs:{md:"6"}},[r("b-form-group",{attrs:{label:"Starts At:","label-for":"coupon-starts-at"}},[r("b-form-datepicker",{attrs:{id:"coupon-starts-at",min:t.minDate,placeholder:"Select start date"},model:{value:t.form.starts_at,callback:function(e){t.$set(t.form,"starts_at",e)},expression:"form.starts_at"}}),t._v(" "),r("b-form-text",{attrs:{variant:"secondary"}},[r("small",[t._v("Leave blank if the coupon is active immediately.")])])],1)],1),t._v(" "),r("b-col",{attrs:{md:"6"}},[r("b-form-group",{attrs:{label:"Expires At:","label-for":"coupon-expires-at"}},[r("b-form-datepicker",{attrs:{id:"coupon-expires-at",min:t.form.starts_at||t.minDate,placeholder:"Select expiration date"},model:{value:t.form.expires_at,callback:function(e){t.$set(t.form,"expires_at",e)},expression:"form.expires_at"}}),t._v(" "),r("b-form-text",{attrs:{variant:"secondary"}},[r("small",[t._v("Leave blank if the coupon never expires.")])])],1)],1)],1),t._v(" "),r("b-form-group",{attrs:{label:"Description:","label-for":"coupon-description"}},[r("b-form-textarea",{attrs:{id:"coupon-description",rows:"3",placeholder:"Enter coupon description"},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1),t._v(" "),r("b-form-group",[r("b-form-checkbox",{attrs:{switch:""},model:{value:t.form.is_active,callback:function(e){t.$set(t.form,"is_active",e)},expression:"form.is_active"}},[t._v("\n          Active\n        ")])],1),t._v(" "),r("b-button",{attrs:{type:"submit",variant:"primary",disabled:t.isSubmitting}},[t.isSubmitting?r("b-spinner",{attrs:{small:""}}):t._e(),t._v("\n        "+t._s(t.isSubmitting?"Updating...":"Update Coupon")+"\n      ")],1),t._v(" "),r("b-button",{staticClass:"ml-2",attrs:{variant:"secondary",to:{name:"AdminCoupons"}}},[t._v("\n        Cancel\n      ")])],1)],1)],1):t.loading?r("div",[r("b-spinner",{attrs:{variant:"primary",label:"Loading..."}}),t._v(" Loading coupon details...\n")],1):r("div",[r("b-alert",{attrs:{variant:"danger",show:""}},[r("h4",[t._v("Error loading coupon")]),t._v(" "),t.errorMessage?r("p",[t._v(t._s(t.errorMessage))]):r("p",[t._v("Coupon not found or an error occurred.")]),t._v(" "),r("b-button",{attrs:{variant:"secondary",to:{name:"AdminCoupons"}}},[t._v("Back to List")])],1)],1)},[],!1,null,"1f7f83f9",null).exports}}]);